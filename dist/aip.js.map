{"version":3,"file":"aip.js","names":["validAIPSignature","bapCell","aipCell","bapDataCell","messageBuffer","Buffer","concat","from","s","BAP_BITCOM_ADDRESS","bitcoinAddress","signatureString","b","Message","verify","e","DEBUG","console","error"],"sources":["../src/aip.js"],"sourcesContent":["import Message from 'bsv/message';\nimport { DEBUG, AIP_BITCOM_ADDRESS, BAP_BITCOM_ADDRESS } from './config.js';\n\n/**\n * Validate AIP signature\n *\n * @param bapCell\n * @param aipCell\n * @param bapDataCell\n * @returns {boolean}\n */\nexport const validAIPSignature = function (bapCell, aipCell, bapDataCell) {\n  try {\n    let messageBuffer = Buffer.concat([\n      Buffer.from('6a', 'hex'), // OP_RETURN\n      Buffer.from(bapCell[0].s),\n      Buffer.from(bapCell[1].s),\n      Buffer.from(bapCell[2].s),\n      Buffer.from(bapCell[3].s),\n      Buffer.from('7c', 'hex'),\n    ]);\n\n    if (bapDataCell) {\n      // data included\n      messageBuffer = Buffer.concat([\n        messageBuffer,\n        Buffer.from(BAP_BITCOM_ADDRESS),\n        Buffer.from('DATA'),\n        Buffer.from(bapDataCell[2].s),\n        Buffer.from(bapDataCell[3].s),\n        Buffer.from('7c', 'hex'),\n      ]);\n    }\n\n    const bitcoinAddress = aipCell[2].s;\n    const signatureString = aipCell[3].b;\n\n    return Message.verify(messageBuffer, bitcoinAddress, signatureString);\n  } catch (e) {\n    if (DEBUG) console.error(e);\n  }\n\n  return false;\n};\n"],"mappings":"mRAWaA,iBAAiB,CAAG,SAAUC,CAAO,CAAEC,CAAO,CAAEC,CAAW,CAAE,CACxE,GAAI,CACF,GAAIC,EAAa,CAAGC,MAAM,CAACC,MAAM,CAAC,CAChCD,MAAM,CAACE,IAAI,CAAC,IAAI,CAAE,KAAK,CAAC,CACxBF,MAAM,CAACE,IAAI,CAACN,CAAO,CAAC,CAAC,CAAC,CAACO,CAAC,CAAC,CACzBH,MAAM,CAACE,IAAI,CAACN,CAAO,CAAC,CAAC,CAAC,CAACO,CAAC,CAAC,CACzBH,MAAM,CAACE,IAAI,CAACN,CAAO,CAAC,CAAC,CAAC,CAACO,CAAC,CAAC,CACzBH,MAAM,CAACE,IAAI,CAACN,CAAO,CAAC,CAAC,CAAC,CAACO,CAAC,CAAC,CACzBH,MAAM,CAACE,IAAI,CAAC,IAAI,CAAE,KAAK,CAAC,CACzB,CAAC,CAEEJ,CAAW,GAEbC,CAAa,CAAGC,MAAM,CAACC,MAAM,CAAC,CAC5BF,CAAa,CACbC,MAAM,CAACE,IAAI,CAACE,0BAAkB,CAAC,CAC/BJ,MAAM,CAACE,IAAI,CAAC,MAAM,CAAC,CACnBF,MAAM,CAACE,IAAI,CAACJ,CAAW,CAAC,CAAC,CAAC,CAACK,CAAC,CAAC,CAC7BH,MAAM,CAACE,IAAI,CAACJ,CAAW,CAAC,CAAC,CAAC,CAACK,CAAC,CAAC,CAC7BH,MAAM,CAACE,IAAI,CAAC,IAAI,CAAE,KAAK,CAAC,CACzB,CAAC,KAGEG,EAAc,CAAGR,CAAO,CAAC,CAAC,CAAC,CAACM,CAAC,CAC7BG,CAAe,CAAGT,CAAO,CAAC,CAAC,CAAC,CAACU,CAAC,CAEpC,MAAOC,oBAAO,CAACC,MAAM,CAACV,CAAa,CAAEM,CAAc,CAAEC,CAAe,CACtE,CAAE,MAAOI,CAAC,CAAE,CACNC,aAAK,EAAEC,OAAO,CAACC,KAAK,CAACH,CAAC,CAC5B,CAEA,QACF,CAAC"}